# PHASE 5.2.2 - –ó–ê–î–ê–ß–ê 1.2 –ó–ê–í–ï–†–®–ï–ù–ê ‚úÖ
# –°–æ–∑–¥–∞–Ω–∏–µ WebSecurityFixTemplates

## üéØ –¶–ï–õ–¨ –ó–ê–î–ê–ß–ò
**–°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è XSS/CSRF —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π**

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø

### 1. –°–æ–∑–¥–∞–Ω–∏–µ WebSecurityFixTemplates.ts (547 —Å—Ç—Ä–æ–∫)
- ‚úÖ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å `WebSecurityRecommendation` —Å –ø–æ–ª–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
- ‚úÖ –ú–µ—Ç–æ–¥—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ XSS –∏ CSRF —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–∏ –ø–æ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø—Ä–æ–±–ª–µ–º
- ‚úÖ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏ —Å–≤–æ–¥–Ω—ã–µ –æ—Ç—á–µ—Ç—ã

### 2. XSS Fix Templates
- ‚úÖ **Dangerous HTML Fix**: {@html} ‚Üí DOMPurify.sanitize()
- ‚úÖ **Unsafe JS Fix**: eval(), innerHTML ‚Üí –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã
- ‚úÖ **Unescaped Input Fix**: –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ **DOM Manipulation Fix**: textContent –≤–º–µ—Å—Ç–æ innerHTML

### 3. CSRF Fix Templates
- ‚úÖ **Unprotected Form Fix**: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ CSRF —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ **Missing Token Fix**: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤ –≤ API endpoints
- ‚úÖ **Cookie Security Fix**: SameSite, Secure, HttpOnly —Ñ–ª–∞–≥–∏
- ‚úÖ **State Changing GET Fix**: POST/PUT/DELETE –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### 4. –û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –≤–µ–±-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ **Content Security Policy (CSP)**: –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- ‚úÖ **Input Validation**: –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **Rate Limiting**: –∑–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫

### 5. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1-10 (10 = –∫—Ä–∏—Ç–∏—á–Ω–æ)
- ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ priority + severity
- ‚úÖ –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

### ‚úÖ –ü–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç –ø—Ä–æ—à–µ–ª:
```
üîß –¢–µ—Å—Ç WebSecurityFixTemplates...

üìã –¢–µ—Å—Ç 1: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è XSS —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π...
‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ 3 XSS —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

üìã –¢–µ—Å—Ç 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è CSRF —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π...
‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ 2 CSRF —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

üìã –¢–µ—Å—Ç 3: –ü–æ–ª–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–µ–±-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π...
‚úÖ –ü–æ–ª–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è: 6 —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

üìä –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞: xss (3), csrf (2), config (1)
üìà –°–≤–æ–¥–∫–∞: 6 —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π, 1 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è, 3 –≤—ã—Å–æ–∫–∏–µ, 6 —á–∞—Å–æ–≤
üíª –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞: 6 —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —Å –¥–æ/–ø–æ—Å–ª–µ
üîó –†–µ—Å—É—Ä—Å—ã: 8 –ø–æ–ª–µ–∑–Ω—ã—Ö —Å—Å—ã–ª–æ–∫, 18 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–µ–≥–æ–≤
```

### üèÜ –¢–æ–ø –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞):
1. **–ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ {@html}** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 10)
2. **–§–æ—Ä–º–∞ –±–µ–∑ CSRF –∑–∞—â–∏—Ç—ã** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 9)
3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Content Security Policy** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 8)

### üíª –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞:
```javascript
// XSS –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
‚ùå –î–æ: {@html userInput}
‚úÖ –ü–æ—Å–ª–µ: {@html DOMPurify.sanitize(userInput)}

// CSRF –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
‚ùå –î–æ: <form method="POST" action="/api/update">
‚úÖ –ü–æ—Å–ª–µ: <form method="POST" action="/api/update">
         <input type="hidden" name="csrf_token" value={csrfToken} />
```

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –û–°–û–ë–ï–ù–ù–û–°–¢–ò

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
```typescript
interface WebSecurityRecommendation {
  id: string;
  title: string;
  description: string;
  severity: 'critical' | 'high' | 'medium' | 'low';
  category: 'xss' | 'csrf' | 'injection' | 'config';
  priority: number; // 1-10
  estimatedTime: string; // "30 minutes", "2 hours"
  codeExample?: { before: string; after: string; description: string };
  steps: string[]; // –î–µ—Ç–∞–ª—å–Ω—ã–µ —à–∞–≥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
  resources: Array<{ title: string; url: string; type: string }>;
  tags: string[];
}
```

### –ú–µ—Ç–æ–¥—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:
- `generateXSSFixes(vulnerabilities)` - —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ XSS —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- `generateCSRFFixes(issues)` - —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ CSRF —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- `generateWebRecommendations(result)` - –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä + –æ–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- `prioritizeRecommendations()` - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏
- `groupRecommendationsByCategory()` - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–ª—è UI
- `generateRecommendationsSummary()` - –∫—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞

### –¢–∏–ø—ã XSS –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- **html_output** ‚Üí DOMPurify —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è
- **inner_html/outer_html** ‚Üí textContent –∏–ª–∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è
- **url_param** ‚Üí –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **dynamic_content** ‚Üí –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—è DOM

### –¢–∏–ø—ã CSRF –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- **form_no_token** ‚Üí –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ CSRF —Ç–æ–∫–µ–Ω–æ–≤ –≤ —Ñ–æ—Ä–º—ã
- **api_no_protection** ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤ –≤ API
- **cookie_no_samesite** ‚Üí –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞—â–∏—Ç–Ω—ã—Ö —Ñ–ª–∞–≥–æ–≤
- **missing_middleware** ‚Üí –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ HTTP –º–µ—Ç–æ–¥–æ–≤

## ‚úÖ –ö–†–ò–¢–ï–†–ò–ò –ü–†–ò–Å–ú–ö–ò –í–´–ü–û–õ–ù–ï–ù–´

1. ‚úÖ **XSS —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è, DOMPurify, –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã**
   - –°–æ–∑–¥–∞–Ω—ã —à–∞–±–ª–æ–Ω—ã –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ XSS —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
   - –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã —Å DOMPurify
   - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –¥–ª—è eval(), innerHTML

2. ‚úÖ **CSRF —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: —Ç–æ–∫–µ–Ω—ã, SameSite cookies, middleware**
   - –®–∞–±–ª–æ–Ω—ã –¥–ª—è —Ñ–æ—Ä–º, API endpoints, cookies
   - –ü—Ä–∏–º–µ—Ä—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CSRF middleware
   - SameSite, Secure, HttpOnly —Ñ–ª–∞–≥–∏

3. ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–∏**
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã 1-10 —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å –æ–±—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ severity + priority
   - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

4. ‚úÖ **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π**
   - –ö–∞–∂–¥–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–æ/–ø–æ—Å–ª–µ –∫–æ–¥
   - –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –ü–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

## üéØ –°–õ–ï–î–£–Æ–©–ò–ô –≠–¢–ê–ü: –ó–ê–î–ê–ß–ê 1.3

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ RecommendationEngine (2 –¥–Ω—è)**
- –î–æ–±–∞–≤–∏—Ç—å –≤–µ–±-–∫–æ–Ω—Ç–µ–∫—Å—Ç –≤ RecommendationEngine.generateRecommendations()
- –û–±–Ω–æ–≤–∏—Ç—å —Ç–∏–ø—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è –≤–µ–±-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞

---

## üìà –ü–†–û–ì–†–ï–°–° PHASE 5.2.2

**–§–ê–ó–ê 1: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π**
- ‚úÖ **–ó–∞–¥–∞—á–∞ 1.1: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è WebSecurityChecker (2 –¥–Ω—è)** - –ó–ê–í–ï–†–®–ï–ù–ê
- ‚úÖ **–ó–∞–¥–∞—á–∞ 1.2: –°–æ–∑–¥–∞–Ω–∏–µ WebSecurityFixTemplates (2 –¥–Ω—è)** - –ó–ê–í–ï–†–®–ï–ù–ê
- ‚è≥ **–ó–∞–¥–∞—á–∞ 1.3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ RecommendationEngine (2 –¥–Ω—è)** - –°–õ–ï–î–£–Æ–©–ê–Ø

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–æ–∑–¥–∞–Ω–∞ –º–æ—â–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π!
WebSecurityFixTemplates –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ, –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–≤–µ—Ç—ã —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∫–æ–¥–∞ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ–±-—É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.
